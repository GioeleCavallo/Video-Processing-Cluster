<?php
#####Dati
function getCsv(){
    $nomeFile = $GLOBALS["FILE_PATH"];
    $data = array();
    if(($handle = fopen($nomeFile, "r")) !== false){
        while(($subData = fgetcsv($handle, 4096, ",")) !== false){
            $data[] = $subData;
        }
        fclose($handle);
    }
    return $data;
}
$data = getCsv();
#####dati statistiche
$quantitaB = 0;
$quantitaI = 0;
$quantitaP = 0;

for($i = 0;$i < COUNT($data); $i++){
	for($j = 0;$j < COUNT($data[$i]); $j++){

		if($j == 17 && $i != 0){
			if($data[$i][$j] == 'B'){
				$quantitaB++;
			}elseif($data[$i][$j] == 'I'){
				$quantitaI++;
			}else{
				$quantitaP++;
			}
		}
	}
}
echo "$quantitaB,$quantitaI,$quantitaP";
#####stampa dei dati statistiche
$totale = $quantitaB+$quantitaI+$quantitaP;
$B = round($quantitaB/$totale*100);
$I = round($quantitaI/$totale*100);
$P = round($quantitaP/$totale*100);
?>

<head>
	<link rel="stylesheet" href="css/stats.css" />
</head>

<html>

<body>
	<div id="center">
		<h1 id="title">Statistics</h1>
		<hr id="title_divisor">
		<div id="drop_not_file_zone">
			<div>
				<?php
				echo getcwd()."Frame B: $B %<br>";
				echo "Frame I: $I %<br>";
				echo "Frame P: $P %<br>";
				?>
				<script src="stats/Chart.js"></script>
				<canvas id="myChart" style="width:50%;height:50%"></canvas>
				<canvas id="frequencyChart" style="width:50%;height:50%"></canvas>
                                <script>
				         var xValues = ["Frame: B", "Frame: I", "Frame: P"];
                                         var yValues = [<?php echo $quantitaB;?>, <?php echo $quantitaI;?>, <?php echo $quantitaP;?>];
                                         var barColors = ["gray","lightgray","Black"];
                                         new Chart("myChart", {
                                                 type: "pie",
                                                 data: {
                                                         labels: xValues,
                                                         datasets: [{
                                                                 backgroundColor: barColors,
                                                                 data: yValues
                                                         }]
                                                 },
                                                 options: {
                                                         title: {
                                                                 display: true,
                                                                 text: "Frequency Frame"
                                                         }
                                                 }
                                         });

					var data = {
    labels: ["Chocolate", "Vanilla", "Strawberry"],
    datasets: [
        {
            label: "Blue",
            backgroundColor: "blue",
            data: [3,7,4]
        },
        {
            label: "Red",
            backgroundColor: "red",
            data: [4,3,5]
        },
        {
            label: "Green",
            backgroundColor: "green",
            data: [7,2,6]
        }
    ]
		};
				</script>
		</div>
		</div>
		<br>
		<h1 id="title">Settings</h1>
		<hr id="title_divisor">
		<div id="drop_not_file_zone">
			<form action="action_page.php"><!-- da cambiare -->
				<input type="checkbox" id="change1" name="change1" value="change1">
				<label for="change1">Motion vector</label><br>

				<input type="checkbox" id="change2" name="change2" value="change2">
				<label for="change2">Recreate with only frames I/B/P</label><br>

				<input type="checkbox" id="change3" name="change3" value="change3">
				<label for="change3">Download Zip with all the I/B/P frames</label><br><br>

				<input type="submit" value="Start">
			</form>
		</div>
		<br>
	</div>
</body>

</html>
